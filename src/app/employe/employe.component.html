<div class="col-12 mt-5">
  <div class="d-flex justify-content-between mb-0 mt-4">
    <button class="btn btn-primary fw-bold mb-3" (click)="ajouterEmployeModal(AjouterModal)">Add New Employe</button>
    <div class="search-bar me-5 pe-5 pe-3 w-50">
      <form class="search-form d-flex align-items-center" method="POST" action="#">
        <input type="text" name="query" placeholder="Search" title="Enter search keyword">
        <button type="submit" title="Search"><i class="bi bi-search"></i></button>
      </form>
    </div><!-- End Search Bar -->
  </div>
  <div class="card me-3">
    <div class="card-body table-responsive-xl ">
      <table class="table table-hover table-striped">
        <thead>
          <th class="pb-2 pt-0 ">CNI</th>
          <th class="pb-2 pt-0">First Name</th>
          <th class="pb-2 pt-0">Last Name</th>
          <th class="pb-2 pt-0">Goal</th>
          <th class="pb-2 pt-0">Reach</th>
          <th class="pb-2 pt-0">Prod.</th>
          <th class="pb-2 pt-0">Birthdate</th>
          <th class="pb-2 pt-0">Retirement</th>
          <th class="pb-2 pt-0">Update</th>
          <th class="pb-2 pt-0">Delete</th>
        </thead>
        <tbody>
          <tr class="align-middle" *ngFor="let e of employes">
            <td class="px-1">{{e.cni}}</td>
            <td class="px-1">{{e.lastname}}</td>
            <td class="px-1">{{e.firstname}}</td>
            <td class="px-1">{{e.objectif}}</td>
            <td class="px-1">{{e.rendement}}</td>
            <td class="px-1">{{e.atteint}}%</td>
            <td class="px-1">{{formatDate(e.birthDate)}}</td>
            <td class="px-1">{{formatDate(e.retraite)}}</td>
            <td><button class="btn btn-success" (click)="modifierEmployeModal(modifierEmployee, e.id)"><i
                  class="bi bi-pencil"></i></button></td>
            <td><button class="btn btn-danger" (click)="supprimerEmploye(e.id)"><i class="bi bi-trash"></i></button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- ajouter Modal -->
  <ng-template #AjouterModal let-modal>
    <div class="modal-header pb-0">
      <h4 class="modal-title" id="ajouter-modal-title">Ajouter</h4>
    </div>
    <form (submit)="ajouterEmploye()" #myForm="ngForm" class="px-3">
      <div class="mb-2">
        <label for="cni" class="form-label">Cni :</label>
        <input type="text" class="form-control" id="cni" [(ngModel)]="newEmploye.cni" name="cni" required>
      </div>
      <div class="mb-2">
        <label for="lastname" class="form-label">Nom:</label>
        <input type="text" class="form-control" id="lastname" [(ngModel)]="newEmploye.lastname" name="lastname"
          required>
      </div>
      <div class="mb-2">
        <label for="firstname" class="form-label">Prénom:</label>
        <input type="text" class="form-control" id="firstname" [(ngModel)]="newEmploye.firstname" name="firstname"
          required>
      </div>
      <div class="mb-2">
        <label for="email" class="form-label">Email:</label>
        <input type="email" class="form-control" id="email" [(ngModel)]="newEmploye.email" name="email" required>
      </div>
      <div class="mb-2">
        <label for="birthDate" class="form-label">Date de naissance :</label>
        <input type="date" class="form-control" id="birthDate" [(ngModel)]="newEmploye.birthDate" name="birthDate"
          required>
      </div>
      <div class="mb-2">
        <label for="rendement" class="form-label">Rendement :</label>
        <input type="number" class="form-control" id="rendement" [(ngModel)]="newEmploye.rendement" name="rendement"
          required>
      </div>
      <div class="mb-2">
        <label for="objectif" class="form-label">Objectif :</label>
        <input type="number" class="form-control" id="objectif" [(ngModel)]="newEmploye.objectif" name="objectif"
          required>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="modal.dismiss('Cross click')">Close</button>
        <button type="submit" class="btn btn-primary" [disabled]="!myForm.form.valid">Save</button>
      </div>
    </form>
  </ng-template>

  <!-- modal Modification -->

  <ng-template #modifierEmployee let-modal>
    <div class="modal-header">
      <h4 class="modal-title" id="modifier-modal-title">Modifier</h4>
    </div>
    <form (ngSubmit)="modifierEmploye()" #modifierForm="ngForm">
      <div class="modal-body">
        <div class="mb-2">
          <label for="cni" class="form-label">Cni :</label>
          <input type="text" class="form-control" id="cni" [(ngModel)]="employe.cni" name="cni" required readonly>
        </div>
        <div class="mb-2">
          <label for="lastname" class="form-label">Nom :</label>
          <input type="text" class="form-control" id="lastname" [(ngModel)]="employe.lastname" name="lastname" required>
        </div>
        <div class="mb-2">
          <label for="firstname" class="form-label">Prénom :</label>
          <input type="text" class="form-control" id="firstname" [(ngModel)]="employe.firstname" name="firstname"
            required>
        </div>

        <div class="mb-2">
          <label for="email" class="form-label">Email :</label>
          <input type="email" class="form-control" id="email" [(ngModel)]="employe.email" name="email" required>
        </div>
        <div class="mb-2">
          <label for="birthDate" class="form-label">Date de naissance :</label>
          <input type="date" class="form-control" id="birthDate" [ngModel]="formatDate(employe.birthDate)"
            name="birthDate" required>
        </div>
        <div class="mb-2">
          <label for="rendement" class="form-label">Rendement :</label>
          <input type="number" class="form-control" id="rendement" [(ngModel)]="employe.rendement" name="rendement"
            required>
        </div>
        <div class="mb-2">
          <label for="objectif" class="form-label">Objectif :</label>
          <input type="number" class="form-control" id="objectif" [(ngModel)]="employe.objectif" name="objectif"
            required>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="modal.dismiss('Cross click')">Close</button>
        <button type="submit" class="btn btn-primary" [disabled]="!modifierForm.form.valid">Save</button>
      </div>
    </form>
  </ng-template>